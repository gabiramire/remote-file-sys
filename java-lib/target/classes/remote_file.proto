syntax = "proto3";
package remote;

option java_multiple_files = true;
option java_package = "remote";
option java_outer_classname = "RemoteFileProto";

service RemoteFileService {
  rpc Open (OpenRequest) returns (OpenResponse);
  rpc Read (ReadRequest) returns (ReadResponse);
  rpc Write (WriteRequest) returns (WriteResponse);
  rpc Close (CloseRequest) returns (CloseResponse);
}

message OpenRequest {
  string nome_arquivo = 1;     // caminho do arquivo no servidor
}

message OpenResponse {
  int32 codigo_erro = 1;       // 0 = OK; <0 = erro
  int32 descritor    = 2;      // identificador do arquivo
  int32 versao       = 3;      // vers찾o inicial (0)
}

message ReadRequest {
  int32 descritor = 1;
  int32 posicao   = 2;
  int32 tamanho   = 3;
}

message ReadResponse {
  int32 codigo_erro = 1;
  int32 bytes_lidos = 2;
  bytes dados       = 3;
  int32 versao      = 4;       // vers찾o atual do arquivo
}

message WriteRequest {
  int32 descritor = 1;
  int32 posicao   = 2;
  bytes dados     = 3;
}

message WriteResponse {
  int32 codigo_erro    = 1;
  int32 bytes_escritos = 2;
  int32 versao         = 3;    // vers찾o ap처s escrita
}

message CloseRequest {
  int32 descritor = 1;
}

message CloseResponse {
  int32 codigo_erro = 1;
}
